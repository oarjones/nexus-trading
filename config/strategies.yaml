# config/strategies.yaml
#
# Configuración de estrategias de trading.
# Cada estrategia puede habilitarse/deshabilitarse
# y configurarse independientemente.
#

# Configuración global
global:
  default_timeframe: "1d"
  signal_ttl_hours: 24
  max_signals_per_run: 10

# Estrategias disponibles
strategies:
  
  # ETF Momentum - Swing Trading
  etf_momentum:
    enabled: true
    description: "Momentum multi-timeframe en ETFs"
    
    # Mercados
    markets:
      - EU
      - US
    
    # Configuración de momentum
    momentum:
      weights:
        1m: 0.40
        3m: 0.30
        6m: 0.20
        12m: 0.10
      min_score: 55
      use_vol_adjusted: true
    
    # Filtros de entrada
    entry:
      top_n: 3
      rsi_low: 40
      rsi_high: 65
      require_above_sma50: true
      min_confidence: 0.55
    
    # Gestión de salida
    exit:
      rsi_high: 75
      max_holding_days: 20
      close_on_rank_drop: true
    
    # Gestión de riesgo (sugerencias, Risk Manager decide)
    risk:
      position_size_pct: 0.05
      atr_stop_multiplier: 2.0
      atr_profit_multiplier: 3.0
      min_risk_reward: 1.5
      max_positions: 5

  # Mean Reversion - Intraday (Fase C2)
  mean_reversion_intraday:
    enabled: false
    description: "Mean reversion intradía en mercados laterales"
    
    timeframe: "5min"
    market: "US"
    
    required_regime:
      - SIDEWAYS
    
    limits:
      max_trades_per_day: 5
      max_exposure_pct: 0.15
      force_close_minutes_before: 10

  # Volatility Breakout - Intraday (Fase C2)
  volatility_breakout:
    enabled: false
    description: "Ruptura de volatilidad intradía"
    
    timeframe: "1min"
    market: "US"
    
    required_regime:
      - VOLATILE
      - BULL
    
    limits:
      max_trades_per_day: 3
      max_exposure_pct: 0.10
      force_close_minutes_before: 15

  # HMM Rules Strategy (Fase 2.1)
  hmm_rules:
    enabled: true
    description: "Estrategia sistemática basada en régimen HMM"
    
    markets:
      - US
    
    required_regime:
      - BULL
      - SIDEWAYS
    
    # Reglas específicas por régimen
    rules:
      bull:
        rsi_entry_threshold: 60
        position_size_pct: 0.05
        stop_loss_pct: 0.03
        take_profit_pct: 0.06
      
      sideways:
        rsi_buy_threshold: 30
        rsi_sell_threshold: 70
        position_size_pct: 0.03
        stop_loss_pct: 0.02
        take_profit_pct: 0.04
    
    risk:
      max_positions: 5
      min_risk_reward: 1.5

    # Schedule: Cada 1 hora durante mercado
    schedule:
      type: "cron"
      days: "mon-fri"
      time: "10:00" # Ejecutar a las 10:00 UTC (ejemplo)
      # Nota: Para testing en loop usaremos interval en runner manual, pero esto config scheduler

  # AI Agent Swing (Fase B2)
  ai_agent_swing:
    enabled: true
    description: "Agente IA para swing trading"
    
    # Schedule: Revisión cada 4 horas
    schedule: 
      type: "interval"
      hours: 4

    autonomy_level: conservative
    agent_config:
      provider: "claude"
      model: "claude-3-5-sonnet-20240620"
      max_tokens: 4096
      temperature: 0.0
    
    symbols:
      - SPY
      - QQQ
      - IWM
      - GLD
      - TLT
    
    required_regime:
      - BULL
      - SIDEWAYS

# Configuración de régimen (referencia a ml_models.yaml)
regime_mapping:
  BULL:
    active_strategies:
      - etf_momentum
      - ai_agent_swing
  BEAR:
    active_strategies: []  # Solo cierres
  SIDEWAYS:
    active_strategies:
      - mean_reversion
      - ai_agent_swing
  VOLATILE:
    active_strategies: []  # Pausar todo
